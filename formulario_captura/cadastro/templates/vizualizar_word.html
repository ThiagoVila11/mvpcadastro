{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h2>{{ documento.titulo }}</h2>
    <p class="text-muted">Upload em: {{ documento.data_upload|date:"d/m/Y H:i" }}</p>
    
    {% if tipo == 'docx' and conteudo %}
    <div class="card mt-3">
        <div class="card-header">
            Visualização do Documento
        </div>
        <div class="card-body">
            <div class="word-content">
                {{ conteudo|linebreaks }}
            </div>
        </div>
    </div>
    {% else %}
    <div class="alert alert-info mt-3">
        <i class="bi bi-file-earmark-word"></i> Este documento não pode ser visualizado diretamente no navegador.
    </div>
    {% endif %}
    
    <div class="mt-3">
        <a href="{{ documento.arquivo_word.url }}" class="btn btn-primary" download>
            <i class="bi bi-download"></i> Baixar Documento
        </a>
        <a href="{% url 'lista_documentos' %}" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Voltar
        </a>
    </div>
</div>

<style>
    .word-content {
        font-family: Arial, sans-serif;
        line-height: 1.6;
    }
    .word-content h1, .word-content h2, .word-content h3 {
        color: #2c3e50;
        margin-top: 1em;
    }
    .word-content p {
        margin-bottom: 1em;
    }
</style>
{% endblock %}